import os
import sys

import django

sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "config.settings")
django.setup()

from apps.menus.models import Menu, StandardMenu
from apps.menus.services import MenuMatchingService


def create_standard_menus():
    """표준 메뉴 생성 (~250개)"""
    standard_menus = [
        # 치킨 (35개)
        ("치킨", "치킨", "치킨"),
        ("후라이드치킨", "후라이드치킨", "치킨"),
        ("양념치킨", "양념치킨", "치킨"),
        ("간장치킨", "간장치킨", "치킨"),
        ("마늘치킨", "마늘치킨", "치킨"),
        ("허니버터치킨", "허니버터치킨", "치킨"),
        ("파닭", "파닭", "치킨"),
        ("치즈치킨", "치즈치킨", "치킨"),
        ("불닭", "불닭", "치킨"),
        ("순살치킨", "순살치킨", "치킨"),
        ("반반치킨", "반반치킨", "치킨"),
        ("두마리치킨", "두마리치킨", "치킨"),
        ("크리스피치킨", "크리스피치킨", "치킨"),
        ("오븐구이치킨", "오븐구이치킨", "치킨"),
        ("찜닭", "찜닭", "치킨"),
        ("간장찜닭", "간장찜닭", "치킨"),
        ("매운찜닭", "매운찜닭", "치킨"),
        ("양념간장치킨", "양념간장치킨", "치킨"),
        ("마늘간장치킨", "마늘간장치킨", "치킨"),
        ("치즈볼치킨", "치즈볼치킨", "치킨"),
        ("치즈스노우치킨", "치즈스노우치킨", "치킨"),
        ("불닭발", "불닭발", "치킨"),
        ("매운불닭", "매운불닭", "치킨"),
        ("파채닭", "파채닭", "치킨"),
        ("마늘소스치킨", "마늘소스치킨", "치킨"),
        ("매콤양념치킨", "매콤양념치킨", "치킨"),
        ("후라이드양념반반", "후라이드양념반반", "치킨"),
        ("순살후라이드", "순살후라이드", "치킨"),
        ("순살양념", "순살양념", "치킨"),
        ("핫크리스피", "핫크리스피", "치킨"),
        ("뿌링클", "뿌링클", "치킨"),
        ("황금올리브", "황금올리브", "치킨"),
        ("맛초킹", "맛초킹", "치킨"),
        ("자메이카통다리", "자메이카통다리", "치킨"),
        ("치킨무", "치킨무", "치킨"),
        
        # 한식-찌개 (12개)
        ("김치찌개", "김치찌개", "한식-찌개"),
        ("된장찌개", "된장찌개", "한식-찌개"),
        ("순두부찌개", "순두부찌개", "한식-찌개"),
        ("부대찌개", "부대찌개", "한식-찌개"),
        ("청국장", "청국장", "한식-찌개"),
        ("두부김치", "두부김치", "한식-찌개"),
        ("동태찌개", "동태찌개", "한식-찌개"),
        ("생태찌개", "생태찌개", "한식-찌개"),
        ("아구찜", "아구찜", "한식-찌개"),
        ("아구탕", "아구탕", "한식-찌개"),
        ("해물탕", "해물탕", "한식-찌개"),
        ("꽃게탕", "꽃게탕", "한식-찌개"),
        
        # 한식-밥 (20개)
        ("비빔밥", "비빔밥", "한식-밥"),
        ("돌솥비빔밥", "돌솥비빔밥", "한식-밥"),
        ("김치볶음밥", "김치볶음밥", "한식-밥"),
        ("제육덮밥", "제육덮밥", "한식-밥"),
        ("참치김치볶음밥", "참치김치볶음밥", "한식-밥"),
        ("새우볶음밥", "새우볶음밥", "한식-밥"),
        ("차돌볶음밥", "차돌볶음밥", "한식-밥"),
        ("해물볶음밥", "해물볶음밥", "한식-밥"),
        ("오므라이스", "오므라이스", "한식-밥"),
        ("산채비빔밥", "산채비빔밥", "한식-밥"),
        ("나물비빔밥", "나물비빔밥", "한식-밥"),
        ("전주비빔밥", "전주비빔밥", "한식-밥"),
        ("낙지비빔밥", "낙지비빔밥", "한식-밥"),
        ("오징어비빔밥", "오징어비빔밥", "한식-밥"),
        ("계란볶음밥", "계란볶음밥", "한식-밥"),
        ("야채볶음밥", "야채볶음밥", "한식-밥"),
        ("베이컨볶음밥", "베이컨볶음밥", "한식-밥"),
        ("김치제육덮밥", "김치제육덮밥", "한식-밥"),
        ("알밥", "알밥", "한식-밥"),
        ("철판볶음밥", "철판볶음밥", "한식-밥"),
        
        # 한식-고기 (25개)
        ("삼겹살", "삼겹살", "한식-고기"),
        ("목살", "목살", "한식-고기"),
        ("갈비", "갈비", "한식-고기"),
        ("불고기", "불고기", "한식-고기"),
        ("항정살", "항정살", "한식-고기"),
        ("갈매기살", "갈매기살", "한식-고기"),
        ("오돌뼈", "오돌뼈", "한식-고기"),
        ("LA갈비", "LA갈비", "한식-고기"),
        ("떡갈비", "떡갈비", "한식-고기"),
        ("갈비탕", "갈비탕", "한식-고기"),
        ("삼계탕", "삼계탕", "한식-고기"),
        ("백숙", "백숙", "한식-고기"),
        ("닭한마리", "닭한마리", "한식-고기"),
        ("제육볶음", "제육볶음", "한식-고기"),
        ("오삼불고기", "오삼불고기", "한식-고기"),
        ("낙지볶음", "낙지볶음", "한식-고기"),
        ("쭈꾸미볶음", "쭈꾸미볶음", "한식-고기"),
        ("낙곱새", "낙곱새", "한식-고기"),
        ("닭갈비", "닭갈비", "한식-고기"),
        ("춘천닭갈비", "춘천닭갈비", "한식-고기"),
        ("닭발", "닭발", "한식-고기"),
        ("매운닭발", "매운닭발", "한식-고기"),
        ("족발", "족발", "한식-고기"),
        ("보쌈", "보쌈", "한식-고기"),
        ("족발보쌈", "족발보쌈", "한식-고기"),
        
        # 한식-분식 (18개)
        ("라면", "라면", "한식-분식"),
        ("떡볶이", "떡볶이", "한식-분식"),
        ("순대", "순대", "한식-분식"),
        ("튀김", "튀김", "한식-분식"),
        ("김밥", "김밥", "한식-분식"),
        ("참치김밥", "참치김밥", "한식-분식"),
        ("치즈김밥", "치즈김밥", "한식-분식"),
        ("야채김밥", "야채김밥", "한식-분식"),
        ("불고기김밥", "불고기김밥", "한식-분식"),
        ("매운떡볶이", "매운떡볶이", "한식-분식"),
        ("치즈떡볶이", "치즈떡볶이", "한식-분식"),
        ("로제떡볶이", "로제떡볶이", "한식-분식"),
        ("야채튀김", "야채튀김", "한식-분식"),
        ("새우튀김", "새우튀김", "한식-분식"),
        ("오징어튀김", "오징어튀김", "한식-분식"),
        ("김말이튀김", "김말이튀김", "한식-분식"),
        ("순대볶음", "순대볶음", "한식-분식"),
        ("어묵", "어묵", "한식-분식"),
        
        # 한식-국/탕 (15개)
        ("갈비탕", "갈비탕", "한식-국/탕"),
        ("삼계탕", "삼계탕", "한식-국/탕"),
        ("육개장", "육개장", "한식-국/탕"),
        ("해장국", "해장국", "한식-국/탕"),
        ("뼈해장국", "뼈해장국", "한식-국/탕"),
        ("선지해장국", "선지해장국", "한식-국/탕"),
        ("내장탕", "내장탕", "한식-국/탕"),
        ("곰탕", "곰탕", "한식-국/탕"),
        ("설렁탕", "설렁탕", "한식-국/탕"),
        ("순대국", "순대국", "한식-국/탕"),
        ("돼지국밥", "돼지국밥", "한식-국/탕"),
        ("콩나물국밥", "콩나물국밥", "한식-국/탕"),
        ("미역국", "미역국", "한식-국/탕"),
        ("떡국", "떡국", "한식-국/탕"),
        ("만두국", "만두국", "한식-국/탕"),
        
        # 한식-면 (10개)
        ("냉면", "냉면", "한식-면"),
        ("물냉면", "물냉면", "한식-면"),
        ("비빔냉면", "비빔냉면", "한식-면"),
        ("칼국수", "칼국수", "한식-면"),
        ("바지락칼국수", "바지락칼국수", "한식-면"),
        ("해물칼국수", "해물칼국수", "한식-면"),
        ("수제비", "수제비", "한식-면"),
        ("잔치국수", "잔치국수", "한식-면"),
        ("콩국수", "콩국수", "한식-면"),
        ("비빔국수", "비빔국수", "한식-면"),
        
        # 한식-전/구이 (8개)
        ("해물파전", "해물파전", "한식-전/구이"),
        ("파전", "파전", "한식-전/구이"),
        ("김치전", "김치전", "한식-전/구이"),
        ("모듬전", "모듬전", "한식-전/구이"),
        ("빈대떡", "빈대떡", "한식-전/구이"),
        ("곱창", "곱창", "한식-전/구이"),
        ("막창", "막창", "한식-전/구이"),
        ("대창", "대창", "한식-전/구이"),
        
        # 중식 (20개)
        ("짜장면", "짜장면", "중식"),
        ("짬뽕", "짬뽕", "중식"),
        ("탕수육", "탕수육", "중식"),
        ("볶음밥", "볶음밥", "중식"),
        ("간짜장", "간짜장", "중식"),
        ("쟁반짜장", "쟁반짜장", "중식"),
        ("삼선짜장", "삼선짜장", "중식"),
        ("해물짬뽕", "해물짬뽕", "중식"),
        ("삼선짬뽕", "삼선짬뽕", "중식"),
        ("짬짜면", "짬짜면", "중식"),
        ("양장피", "양장피", "중식"),
        ("깐풍기", "깐풍기", "중식"),
        ("깐쇼새우", "깐쇼새우", "중식"),
        ("마파두부", "마파두부", "중식"),
        ("유산슬", "유산슬", "중식"),
        ("팔보채", "팔보채", "중식"),
        ("울면", "울면", "중식"),
        ("잡채밥", "잡채밥", "중식"),
        ("만두", "만두", "중식"),
        ("군만두", "군만두", "중식"),
        
        # 피자 (15개)
        ("페퍼로니피자", "페퍼로니피자", "피자"),
        ("콤비네이션피자", "콤비네이션피자", "피자"),
        ("불고기피자", "불고기피자", "피자"),
        ("포테이토피자", "포테이토피자", "피자"),
        ("치즈피자", "치즈피자", "피자"),
        ("더블치즈피자", "더블치즈피자", "피자"),
        ("마르게리타피자", "마르게리타피자", "피자"),
        ("쉬림프피자", "쉬림프피자", "피자"),
        ("하와이안피자", "하와이안피자", "피자"),
        ("슈퍼슈프림피자", "슈퍼슈프림피자", "피자"),
        ("고구마피자", "고구마피자", "피자"),
        ("바비큐피자", "바비큐피자", "피자"),
        ("미트러버피자", "미트러버피자", "피자"),
        ("야채피자", "야채피자", "피자"),
        ("고르곤졸라피자", "고르곤졸라피자", "피자"),
        
        # 양식 (18개)
        ("스테이크", "스테이크", "양식"),
        ("안심스테이크", "안심스테이크", "양식"),
        ("등심스테이크", "등심스테이크", "양식"),
        ("파스타", "파스타", "양식"),
        ("까르보나라", "까르보나라", "양식"),
        ("알리오올리오", "알리오올리오", "양식"),
        ("로제파스타", "로제파스타", "양식"),
        ("토마토파스타", "토마토파스타", "양식"),
        ("봉골레파스타", "봉골레파스타", "양식"),
        ("해물파스타", "해물파스타", "양식"),
        ("리조또", "리조또", "양식"),
        ("해물리조또", "해물리조또", "양식"),
        ("크림리조또", "크림리조또", "양식"),
        ("버섯리조또", "버섯리조또", "양식"),
        ("샐러드", "샐러드", "양식"),
        ("시저샐러드", "시저샐러드", "양식"),
        ("연어샐러드", "연어샐러드", "양식"),
        ("닭가슴살샐러드", "닭가슴살샐러드", "양식"),
        
        # 버거 (12개)
        ("햄버거", "햄버거", "버거"),
        ("치즈버거", "치즈버거", "버거"),
        ("더블치즈버거", "더블치즈버거", "버거"),
        ("불고기버거", "불고기버거", "버거"),
        ("새우버거", "새우버거", "버거"),
        ("베이컨햄버거", "베이컨햄버거", "버거"),
        ("치킨버거", "치킨버거", "버거"),
        ("크리스피버거", "크리스피버거", "버거"),
        ("감자튀김", "감자튀김", "버거"),
        ("치킨너겟", "치킨너겟", "버거"),
        ("어니언링", "어니언링", "버거"),
        ("치즈스틱", "치즈스틱", "버거"),
        
        # 일식 (25개)
        ("돈까스", "돈까스", "일식"),
        ("등심돈까스", "등심돈까스", "일식"),
        ("치즈돈까스", "치즈돈까스", "일식"),
        ("우동", "우동", "일식"),
        ("해물우동", "해물우동", "일식"),
        ("튀김우동", "튀김우동", "일식"),
        ("초밥", "초밥", "일식"),
        ("모듬초밥", "모듬초밥", "일식"),
        ("연어초밥", "연어초밥", "일식"),
        ("회덮밥", "회덮밥", "일식"),
        ("연어덮밥", "연어덮밥", "일식"),
        ("광어덮밥", "광어덮밥", "일식"),
        ("모듬회덮밥", "모듬회덮밥", "일식"),
        ("라멘", "라멘", "일식"),
        ("돈코츠라멘", "돈코츠라멘", "일식"),
        ("미소라멘", "미소라멘", "일식"),
        ("규동", "규동", "일식"),
        ("가츠동", "가츠동", "일식"),
        ("텐동", "텐동", "일식"),
        ("타코야끼", "타코야끼", "일식"),
        ("오코노미야끼", "오코노미야끼", "일식"),
        ("카레라이스", "카레라이스", "일식"),
        ("장어덮밥", "장어덮밥", "일식"),
        ("사시미", "사시미", "일식"),
        ("야끼소바", "야끼소바", "일식"),
        
        # 카페/디저트 (12개)
        ("아메리카노", "아메리카노", "카페"),
        ("카페라떼", "카페라떼", "카페"),
        ("카푸치노", "카푸치노", "카페"),
        ("카라멜마끼야또", "카라멜마끼야또", "카페"),
        ("바닐라라떼", "바닐라라떼", "카페"),
        ("녹차라떼", "녹차라떼", "카페"),
        ("빙수", "빙수", "카페"),
        ("팥빙수", "팥빙수", "카페"),
        ("망고빙수", "망고빙수", "카페"),
        ("케이크", "케이크", "카페"),
        ("치즈케이크", "치즈케이크", "카페"),
        ("티라미수", "티라미수", "카페"),
    ]

    for name, normalized, category in standard_menus:
        StandardMenu.objects.get_or_create(
            name=name,
            defaults={"normalized_name": normalized, "category": category},
        )
    print(f"Created {len(standard_menus)} standard menus")


def create_sample_menus():
    """샘플 메뉴 생성 및 매칭"""
    sample_menus = [
        # 다양한 형태의 김치찌개
        ("얼큰 김치찌개 1인분", "REST001", 8000),
        ("김치찌개(特)", "REST002", 9000),
        ("돼지고기 김치찌개", "REST003", 8500),
        ("김치찌개 2인분", "REST001", 15000),
        # 된장찌개
        ("구수한 된장찌개", "REST001", 7000),
        ("된장찌개 [추천]", "REST002", 7500),
        # 비빔밥
        ("석쇠 비빔밥", "REST004", 9000),
        ("비빔밥 (야채 많이)", "REST004", 9000),
        ("돌솥비빔밥 大", "REST005", 10000),
        # 삼겹살
        ("한돈 삼겹살 200g", "REST006", 13000),
        ("삼겹살 구이", "REST006", 12000),
        # 치킨
        ("후라이드 치킨 (순살)", "REST007", 16000),
        ("양념 치킨", "REST007", 17000),
        # 중식
        ("간짜장", "REST008", 6000),
        ("해물 짬뽕", "REST008", 8000),
        ("탕수육 (소)", "REST008", 15000),
    ]

    service = MenuMatchingService()
    for original_name, restaurant_code, price in sample_menus:
        menu = service.create_and_match_menu(
            original_name=original_name,
            restaurant_code=restaurant_code,
            price=price,
        )
        status = "MATCHED" if menu.standard_menu else "NOT MATCHED"
        name = menu.standard_menu.name if menu.standard_menu else "None"
        conf = f" ({menu.match_confidence:.2f})" if menu.match_confidence else ""
        print(f"{status}{conf}: {original_name} -> {name}")
    print(f"Created {len(sample_menus)} sample menus")


def print_statistics():
    """통계 출력"""
    total_menus = Menu.objects.count()
    matched_menus = Menu.objects.filter(standard_menu__isnull=False).count()
    match_rate = (matched_menus / total_menus * 100) if total_menus > 0 else 0

    print("\nStatistics:")
    print(f"  Standard Menus: {StandardMenu.objects.count()}")
    print(f"  Menus: {total_menus}, Matched: {matched_menus}, Rate: {match_rate:.1f}%")


if __name__ == "__main__":
    create_standard_menus()
    create_sample_menus()
    print_statistics()
    print("Done. API: /api/menus/, Admin: /admin/, Docs: /api/docs/")
